<section class="py-20 px-4">
  <div class="container mx-auto max-w-6xl">
    <!-- Profile Header -->
    <div class="card mb-8">
      <div
        class="flex flex-col md:flex-row items-start md:items-center justify-between"
      >
        <div class="flex items-center space-x-4 mb-4 md:mb-0">
          <div
            class="w-20 h-20 bg-zus-orange rounded-full flex items-center justify-center"
          >
            <span class="text-zus-black font-bold text-2xl">
              {{ profileForm.get("firstName")?.value?.charAt(0)
              }}{{ profileForm.get("lastName")?.value?.charAt(0) }}
            </span>
          </div>
          <div>
            <h1 class="text-3xl font-bold">
              {{ profileForm.get("firstName")?.value }}
              {{ profileForm.get("lastName")?.value }}
            </h1>
            <p class="text-white/80">{{ profileForm.get("email")?.value }}</p>
            <p class="text-zus-orange text-sm">Cz≈Çonek od pa≈∫dziernika 2024</p>
          </div>
        </div>
        <div class="flex space-x-3">
          <button
            *ngIf="!isEditing"
            (click)="toggleEdit()"
            class="btn-secondary"
          >
            Edytuj profil
          </button>
          <button
            *ngIf="isEditing"
            (click)="saveProfile()"
            class="btn-primary"
            [disabled]="profileForm.invalid"
          >
            Zapisz zmiany
          </button>
          <button
            *ngIf="isEditing"
            (click)="cancelEdit()"
            class="btn-secondary"
          >
            Anuluj
          </button>
        </div>
      </div>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">
      <!-- Profile Form -->
      <div class="lg:col-span-2">
        <div class="card">
          <h2 class="text-2xl font-bold mb-6">Dane osobowe</h2>

          <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
            <div class="grid md:grid-cols-2 gap-6">
              <!-- First Name -->
              <div>
                <label class="form-label">Imiƒô</label>
                <input
                  type="text"
                  formControlName="firstName"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                />
              </div>

              <!-- Last Name -->
              <div>
                <label class="form-label">Nazwisko</label>
                <input
                  type="text"
                  formControlName="lastName"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                />
              </div>

              <!-- Email -->
              <div>
                <label class="form-label">Email</label>
                <input
                  type="email"
                  formControlName="email"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                />
              </div>

              <!-- Phone -->
              <div>
                <label class="form-label">Telefon</label>
                <input
                  type="tel"
                  formControlName="phone"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                />
              </div>

              <!-- Birth Date -->
              <div>
                <label class="form-label">Data urodzenia</label>
                <input
                  type="date"
                  formControlName="birthDate"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                />
              </div>

              <!-- Current Salary -->
              <div>
                <label class="form-label">Obecne wynagrodzenie (brutto)</label>
                <div class="relative">
                  <input
                    type="number"
                    formControlName="currentSalary"
                    class="form-input pr-12"
                    [class.opacity-60]="!isEditing"
                  />
                  <span
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60"
                    >z≈Ç</span
                  >
                </div>
              </div>

              <!-- Work Start Year -->
              <div>
                <label class="form-label">Rok rozpoczƒôcia pracy</label>
                <input
                  type="number"
                  formControlName="workStartYear"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                  min="1980"
                  max="2024"
                />
              </div>

              <!-- Planned Retirement Year -->
              <div>
                <label class="form-label">Planowany rok emerytury</label>
                <input
                  type="number"
                  formControlName="plannedRetirementYear"
                  class="form-input"
                  [class.opacity-60]="!isEditing"
                  min="2024"
                  max="2070"
                />
              </div>
            </div>
          </form>
        </div>

        <!-- Simulation History -->
        <div class="card mt-8">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">Historia symulacji</h2>
            <button (click)="downloadReport()" class="btn-primary">
              Pobierz raport
            </button>
          </div>

          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="border-b border-white/10">
                  <th class="text-left py-3 px-4 font-semibold">Data</th>
                  <th class="text-left py-3 px-4 font-semibold">
                    Przewidywana emerytura
                  </th>
                  <th class="text-left py-3 px-4 font-semibold">Status</th>
                  <th class="text-left py-3 px-4 font-semibold">Akcje</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let simulation of simulationHistory; let i = index"
                  class="border-b border-white/5 hover:bg-white/5"
                >
                  <td class="py-3 px-4 text-white/80">{{ simulation.date }}</td>
                  <td class="py-3 px-4 font-semibold text-zus-orange">
                    {{
                      simulation.pension | currency : "PLN" : "symbol" : "1.0-0"
                    }}
                  </td>
                  <td class="py-3 px-4">
                    <span
                      class="px-2 py-1 bg-zus-green/20 text-zus-green rounded-full text-sm"
                    >
                      {{ simulation.status }}
                    </span>
                  </td>
                  <td class="py-3 px-4">
                    <button
                      (click)="deleteSimulation(i)"
                      class="text-zus-red hover:text-zus-red/80 text-sm"
                    >
                      Usu≈Ñ
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Statistics Sidebar -->
      <div class="space-y-6">
        <!-- Quick Stats -->
        <div class="card">
          <h3 class="text-xl font-bold mb-4">Twoje statystyki</h3>
          <div class="space-y-4">
            <div class="flex justify-between items-center">
              <span class="text-white/80">Liczba symulacji:</span>
              <span class="font-bold text-zus-orange">{{
                userStats.simulationsCount
              }}</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-white/80">≈örednia emerytura:</span>
              <span class="font-bold text-zus-green">{{
                userStats.averagePension | currency : "PLN" : "symbol" : "1.0-0"
              }}</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-white/80">Ostatnia symulacja:</span>
              <span class="font-bold text-white">{{
                userStats.lastSimulation
              }}</span>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
          <h3 class="text-xl font-bold mb-4">Szybkie akcje</h3>
          <div class="space-y-3">
            <button routerLink="/calculator" class="btn-primary w-full">
              Nowa symulacja
            </button>
            <button (click)="downloadReport()" class="btn-secondary w-full">
              Pobierz pe≈Çny raport
            </button>
            <button class="btn-secondary w-full">Ustawienia konta</button>
          </div>
        </div>

        <!-- Tips -->
        <div class="card bg-zus-orange/10 border-zus-orange/20">
          <h3 class="text-xl font-bold mb-4 text-zus-orange">üí° Wskaz√≥wka</h3>
          <p class="text-white/90 text-sm">
            Regularnie aktualizuj swoje dane, aby otrzymywaƒá najbardziej
            dok≈Çadne prognozy emerytalne.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
